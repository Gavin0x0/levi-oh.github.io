(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{511:function(t,s,n){"use strict";n.r(s);var a=n(6),e=Object(a.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"前期准备"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前期准备"}},[t._v("#")]),t._v(" 前期准备")]),t._v(" "),n("hr"),t._v(" "),n("ul",[n("li",[t._v("💰 当然是用来买服务器啊")]),t._v(" "),n("li",[t._v("Termius ✅  「MacOS软件-用于连接到服务器」")]),t._v(" "),n("li",[t._v("Navicat Premium ✅ 「全平台软件-用于连接数据库」")]),t._v(" "),n("li",[t._v("Visual Studio Code ✅ 「全平台软件-yyds」")]),t._v(" "),n("li",[t._v("完成的前端项目「vue」")]),t._v(" "),n("li",[t._v("完成的后端项目「JFinal」")])]),t._v(" "),n("h2",{attrs:{id:"购买服务器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#购买服务器"}},[t._v("#")]),t._v(" 购买服务器")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("这是我购买的第三台云服务器了，有了前两次的摸爬滚打，这次总算顺利不少"),n("br"),t._v("\n服务器选的阿里云的学生机，比腾讯的便宜不知道多少，一年才96 💰，一共优惠了1644 💰！\n配置选的是「Ubuntu 18.04-1核2G」的版本\n"),n("img",{attrs:{src:"http://tva1.sinaimg.cn/large/007e6d0Xgy1go9mz4rco0j31tm0riwxr.jpg",alt:"image.png"}})]),t._v(" "),n("h2",{attrs:{id:"配置服务器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置服务器"}},[t._v("#")]),t._v(" 配置服务器")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("服务器整到手后先配置远程连接的密码，然后用「Termius」连上服务器，开始进行配置\n安装nginx反代工具")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" nginx  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装nginx")]),t._v("\n")])])]),n("p",[t._v("nginx的基本操作")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("/etc/init.d/nginx start "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#启动")]),t._v("\n/etc/init.d/nginx reload "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#重启")]),t._v("\n/etc/init.d/nginx stop "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#停止")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" nginx start    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" nginx reload   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重载")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" nginx restart  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重启")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" nginx stop     "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 停止")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" /usr/local/nginx/sbin/nginx -v  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看版本")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" /usr/local/nginx/sbin/nginx     "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" /usr/local/nginx/sbin/nginx -s stop   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 停止")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" /usr/local/nginx/sbin/nginx -s reload "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重启")]),t._v("\n")])])]),n("p",[t._v("由于这次配置的是基于vue的单页面应用，所以要对nginx进行配置修改"),n("br"),t._v("\n在本地新建一个 eta_vue.conf 文件，写入以下内容")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#服务启动时监听的端口")]),t._v("\n    listen "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" default_server"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    listen "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("::"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":80 default_server"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#服务启动时文件加载的路径")]),t._v("\n    root /var/www/html/eta_vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#默认加载的第一个文件")]),t._v("\n    index index.php index.html index.htm index.nginx-debian.html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#页面访问域名，如果没有域名也可以填写_")]),t._v("\n    server_name www.632891553.xyz"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    location / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#页面加载失败后所跳转的页面")]),t._v("\n        try_files "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" /index.html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n      \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#以下配置只服务于php")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将PHP脚本传递给在127.0.0.1:9000上监听的FastCGI服务器")]),t._v("\n    location ~ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(".php$ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        include snippets/fastcgi-php.conf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# With php7.0-cgi alone:")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#fastcgi_pass 127.0.0.1:9000;")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# With php7.0-fpm:")]),t._v("\n        fastcgi_pass unix:/run/php/php7.0-fpm.sock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果Apache的文档为root，则拒绝访问.htaccess文件")]),t._v("\n    location ~ /"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(".ht "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        deny all"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("通过「Termius」的SFTP将上面的文件放入服务器的 "),n("code",[t._v("/etc/nginx/conf.d")]),t._v(" 路径下"),n("br"),t._v("\n并将 "),n("code",[t._v("/etc/nginx")]),t._v(" 下的 nginx.conf 文件中最后一行的默认配置注释掉（如下图）"),n("br"),t._v(" "),n("img",{attrs:{src:"http://tva1.sinaimg.cn/large/007e6d0Xgy1go9nkqhvm4j308y02dt8l.jpg",alt:"image.png"}}),n("br"),t._v("\n修改完成后重启一次nginx"),n("br"),t._v("\n将打包好的前端项目放入 "),n("code",[t._v("/var/www/html/eta_vue")]),t._v(" 文件夹下"),n("br"),t._v("\n进入浏览器，地址栏输入服务器ip，能看到前端页面就算配置好了")]),t._v(" "),n("h2",{attrs:{id:"安装数据库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装数据库"}},[t._v("#")]),t._v(" 安装数据库")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("数据库安装很方便只，需要以下几条命令")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" mysql-server\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" mysql-client\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" libmysqlclient-dev\n")])])]),n("p",[t._v("安装好后用下面的命令来初始化安全设置")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("mysql_secure_installation\n")])])]),n("p",[t._v("会询问是否执行以下几步操作，为了方便之后数据库管理，先选择开放远程登陆许可")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("为root用户设置密码")])]),t._v(" "),n("li",[n("p",[t._v("删除匿名账号「是」")])]),t._v(" "),n("li",[n("p",[t._v("取消root用户远程登录 「否」")])]),t._v(" "),n("li",[n("p",[t._v("删除test库和对test库的访问权限 「是」")])]),t._v(" "),n("li",[n("p",[t._v("刷新授权表使修改生效 「是」")])])]),t._v(" "),n("h2",{attrs:{id:"连接数据库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#连接数据库"}},[t._v("#")]),t._v(" 连接数据库")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("连接数据库前要先检查下3306端口是否可用\n"),n("a",{attrs:{href:"https://blog.csdn.net/freezingxu/article/details/77088506",target:"_blank",rel:"noopener noreferrer"}},[t._v("附上教程"),n("OutboundLink")],1),n("br"),t._v("\n教程中一些关于「vim」的操作可用参考我的另一篇指南 "),n("RouterLink",{attrs:{to:"/notes/Vim.html"}},[t._v("Vim 基础")]),n("br"),t._v("\n端口开启后千万要记得去阿里云控制台开启3306端口！！「我在这里浪费了将近2个小时🥲 」\n"),n("img",{attrs:{src:"http://tva1.sinaimg.cn/large/007e6d0Xgy1go9qs4ef8sj30ou0c9mxu.jpg",alt:"image.png"}})],1),t._v(" "),n("h2",{attrs:{id:"部署后端"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#部署后端"}},[t._v("#")]),t._v(" 部署后端")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("首先利用 "),n("code",[t._v("apt-get")]),t._v(" 指令快速安装好 jdk1.8\n然后把打包好的后端项目上传至服务器 "),n("code",[t._v("/home/cxxy")]),t._v(" 目录下"),n("br"),t._v("\n解压文件")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /home/cxxy/\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("tar")]),t._v(" -zxvf ETA6-release.tar.gz\n")])])]),n("p",[t._v("修改解压出来的文件里的数据库配置、undertow端口号"),n("br"),t._v("\n启动项目")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /home/cxxy/ETA6\n ./start.sh start\n")])])]),n("p",[t._v("关闭项目「重新部署前建议先关闭」")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /home/cxxy/ETA6\n ./stop.sh stop\n")])])]),n("h2",{attrs:{id:"解决跨域"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#解决跨域"}},[t._v("#")]),t._v(" 解决跨域")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("作为前后端分离项目，跨域问题必须克服"),n("br"),t._v("\n首先修改后端项目运行的端口「默认的80端已经被nginx占用了」"),n("br"),t._v("\n服务器 "),n("code",[t._v("/home/cxxy/ETA6")]),t._v(" 目录下，修改 undertow.txt")])])}),[],!1,null,null,null);s.default=e.exports}}]);